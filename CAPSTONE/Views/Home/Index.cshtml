
@{
    ViewBag.Title = "Tanauan Violation Checker";
    Layout = "~/Views/Shared/_Index.cshtml";
}

<input type="text" class="form-control round-form" title="Please input text with this fomat ABC-12345" placeholder="eg. ABC-12345" style="text-align:center; margin-bottom:50px;" id="inp_platenumber" onchange="updateGrid()"  maxlength="9">

<section id="no-more-tables">
    @* tbl enforcer account will be inserted here programmatically *@
</section>

<script type="text/javascript">
    String.prototype.splice = function (idx, rem, str) {
        return this.slice(0, idx) + str + this.slice(idx + Math.abs(rem));
    };

    $(document).ready(function () {
        //updateGrid();
        var tele = document.querySelector('#inp_platenumber');

        tele.addEventListener('keyup', function (e) {
            if (event.key != 'Backspace' && (tele.value.length === 3)) {
                tele.value += '-';
                if ($("#inp_platenumber").val()[3] != "-") {
                    tele.value.splice(3, 0, "-")
                }
            }
        });
    });

    function updateGrid() {
        var plate = "%" + $("#inp_platenumber").val() + "%";
        console.log(plate);

        $("#myModal_reload").modal({ backdrop: 'static', keyboard: false }, 'show');
        $.ajax({
            url: "https://trafficmanagementofficetanauan.somee.com/Systems/prop_get_record_by_plateno?platenumber=" + $("#inp_platenumber").val(),
            type: "POST",
            crossDomain: true,
            dataType: "text",
            success: function (response) {
                data = someerm(response);
                var Json_Data = JSON.parse(data);
                console.log(Json_Data.length);
                var has = "NO";
                if (Json_Data.length > 0) {
                    has = "YES";
                }

                document.getElementById("no-more-tables").innerHTML = `<h1>`+has+`</h1>`;

                $("#myModal_reload").modal("hide");
            }, error: function (xhr, status) {
                console.log("error");
            }
        })
    }
</script>